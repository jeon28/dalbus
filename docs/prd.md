# [프로젝트 달버스] 요구사항 정의서 (PRD) v2.0

| 항목 | 내용 |
| :--- | :--- |
| **문서 버전** | v2.0 |
| **최종 수정일** | 2025-02-07 |
| **작성자** | 달버스 기획팀 |
| **문서 목적** | 화면 설계서 및 기술 설계서(DB, API)의 입력 자료 |
| **참조 사이트** | [쉐어킹 (shareking.kr)](https://shareking.kr/) |

---

## 목차

1. [프로젝트 비전](#1-프로젝트-비전)
2. [용어 정의](#2-용어-정의)
3. [비즈니스 모델 및 운영 정책](#3-비즈니스-모델-및-운영-정책)
4. [사용자 여정 (User Flow)](#4-사용자-여정)
5. [권한 관리](#5-권한-관리)
6. [화면 인벤토리](#6-화면-인벤토리)
7. [요구사항 리스트 (Backlog)](#7-요구사항-리스트)
8. [Jira 기반 상세 요구사항 (Epics & Issues)](#8-jira-기반-상세-요구사항)
9. [핵심 데이터 모델](#9-핵심-데이터-모델)
10. [제약 사항 및 기술 요구사항](#10-제약-사항-및-기술-요구사항)
11. [외부 서비스 의존성](#11-외부-서비스-의존성)
12. [법적 요구사항](#12-법적-요구사항)
13. [제외 사항 (Out of Scope)](#13-제외-사항)

---

## 1. 프로젝트 비전 (The North Star)

### 1.1 목적

고가의 프리미엄 구독 서비스(Tidal, Netflix 등)를 이용하고 싶지만 단독 구독 비용에 부담을 느끼는 사용자들에게, 신뢰할 수 있는 계정 공유 환경을 제공하여 구독 비용을 효율적으로 절감해 줍니다.

### 1.2 핵심 목표

| 목표 | 지표 | 기준값 |
| :--- | :--- | :--- |
| 서비스 전개 속도 | 기획~MVP 배포 | 4주 이내 |
| 사용자 경험 | 구매~계정 정보 수령 | 3단계 이내 (구매 → SMS 수신 → 서비스 이용) |
| 운영 신뢰성 | 계정 충돌 발생률 | 1% 미만 |
| 계정 배정 속도 | 결제 완료~계정 배정 | 영업시간 기준 2시간 이내 |

---

## 2. 용어 정의 (Glossary)

| 용어 | 정의 |
| :--- | :--- |
| **기간권** | 특정 기간(1개월/3개월 등) 동안 서비스를 이용할 수 있는 상품 단위 |
| **공유 계정** | 달버스가 보유한 프리미엄 서비스의 ID/PW 조합. 구매자에게 배정되어 사용 |
| **배정** | 결제 완료된 주문에 대해 관리자가 공유 계정을 할당하는 행위 |
| **독립계정 방식** | 사용자에게 독립된 계정(ID/PW)을 제공하여 기존 계정과 간섭 없이 사용하는 방식 |
| **초대 방식** | 기존 가족/팀 플랜에 사용자를 멤버로 초대하여 공유하는 방식 |
| **계정 교체** | 서비스 제공사 정책 변경 등으로 기존 계정이 차단되어 새 계정으로 교체하는 운영 행위 |
| **PG사** | Payment Gateway. 결제 대행 서비스 (본 프로젝트는 PortOne 사용) |

---

## 3. 비즈니스 모델 및 운영 정책

### 3.1 상품 구조

| 항목 | 설명 |
| :--- | :--- |
| **판매 서비스** | Tidal (MVP 기준), 향후 Netflix, YouTube Premium 등 확장 |
| **상품 단위** | 기간권 (1개월 / 3개월) |
| **계정 공유 방식** | 독립계정 방식 (MVP 기준. 사용자별 개별 ID/PW 제공) |
| **가격 정책** | 서비스별 × 기간별 매트릭스. 장기권 할인율 적용 |

**가격 테이블 예시 (Tidal 기준):**

| 기간 | 정가 (월) | 달버스 가격 | 할인율 |
| :--- | :--- | :--- | :--- |
| 1개월 | ₩10,990 | ₩5,900 | 46% |
| 3개월 | ₩10,990/월 | ₩14,900 (₩4,967/월) | 55% |

> ※ 가격은 관리자가 실시간 변경 가능. 위 금액은 예시입니다.

### 3.2 계정 배정 정책

| 항목 | 정책 |
| :--- | :--- |
| **배정 방식** | 관리자 수동 배정 (MVP) |
| **배정 SLA** | 영업시간(09:00~22:00) 기준 2시간 이내 |
| **배정 알림** | SMS + 마이페이지 노출 |
| **배정 대기 안내** | 결제 완료 화면에 "영업시간 기준 2시간 이내 SMS로 계정 정보를 보내드립니다" 문구 노출 |

### 3.3 구독 갱신 및 만료 정책

| 항목 | 정책 |
| :--- | :--- |
| **만료 알림** | 만료 7일 전, 1일 전 SMS 발송 |
| **자동 연장** | 미지원 (MVP). 수동 재구매 유도 |
| **만료 후 처리** | 마이페이지에서 계정 정보 비노출 처리. 재구매 유도 배너 노출 |
| **재구매** | 만료된 사용자는 상품 페이지에서 동일 플로우로 재구매 |

### 3.4 환불 및 취소 정책

| 항목 | 정책 |
| :--- | :--- |
| **계정 배정 전** | 전액 환불 가능 (관리자 수동 처리) |
| **계정 배정 후** | 환불 불가 (서비스 특성상. 이용약관에 명시) |
| **환불 요청 채널** | 채널톡 / 카카오톡 고객센터 |
| **환불 처리 기간** | 요청일로부터 3영업일 이내 |
| **환불 시 계정 회수** | 관리자가 해당 주문의 배정 계정을 회수(풀 반납) 처리 |

### 3.5 계정 장애 대응 정책

| 상황 | 대응 |
| :--- | :--- |
| **계정 차단/비밀번호 변경** | 공지사항 등록 + SMS 알림 + 신규 계정 재배정 |
| **서비스 자체 장애** | 공지사항으로 상황 공유. 달버스 귀책이 아닌 경우 별도 보상 없음 |
| **대량 장애 (계정 대란)** | 긴급 공지 + 전체 사용자 일괄 재배정 + 보상 기간 연장 검토 |

---

## 4. 사용자 여정 (User Flow)

### 4.1 Happy Path: 구매자 여정

```
[비회원/회원]
    │
    ▼
(1) 랜딩 페이지 방문
    │ - 서비스 소개, 가격 비교, 이용 방법, 리뷰 확인
    ▼
(2) 상품 목록 조회
    │ - 서비스 카드(아이콘, 이름, 월 이용료, 할인율)
    ▼
(3) 상품 상세 진입
    │ - 혜택, 유의사항, 기간 선택
    ▼
(4) 기간 선택 + 결제
    │ - 비회원인 경우: 로그인/회원가입 유도 후 결제
    │ - 회원인 경우: 바로 결제
    │ - PG사(PortOne) 결제창 호출
    ▼
(5) 결제 완료
    │ - 완료 화면: "영업시간 기준 2시간 이내 SMS 발송" 안내
    │ - 주문 상태: '결제완료'
    ▼
(6) [관리자] 계정 배정
    │ - 관리자 대시보드에서 결제완료 건 확인
    │ - 공유 계정 풀에서 계정 선택 → 주문에 배정
    │ - 주문 상태: '배정완료' → '이용중'
    ▼
(7) SMS 수신 + 마이페이지 확인
    │ - SMS: "계정이 배정되었습니다. 마이페이지에서 확인하세요"
    │ - 마이페이지: ID/PW 노출 (복사 기능), 만료일, D-Day
    ▼
(8) 실제 서비스 이용
    │ - Tidal 앱/웹에서 배정받은 ID/PW로 로그인
    ▼
(9) 만료 접근
    │ - D-7, D-1 SMS 알림
    │ - 마이페이지: 재구매 유도 배너 노출
    ▼
(10) 재구매 또는 종료
```

### 4.2 관리자 운영 플로우

```
[관리자 로그인]
    │
    ▼
(A) 주문 대시보드 확인
    │ - 상태별 필터: 결제대기/결제완료/배정완료/이용중/만료/취소
    │ - 신규 '결제완료' 건 확인
    ▼
(B) 계정 배정
    │ - 해당 주문의 서비스에 맞는 공유 계정 선택
    │ - ID/PW 입력 (또는 계정 풀에서 선택)
    │ - 배정 완료 → 사용자 SMS 자동 발송
    ▼
(C) 상품 관리
    │ - 가격 변경, 상품 활성/비활성, 태그 수정
    ▼
(D) 계정 풀 관리
    │ - 공유 계정 등록/수정/비활성화
    │ - 계정별 배정 현황 확인
    ▼
(E) 공지사항 / FAQ 관리
    │ - 계정 교체, 서비스 장애 등 공지 작성
    ▼
(F) 매출 통계
    │ - 기간별 매출 합계, 서비스별 매출, 주문 건수
```

### 4.3 비정상 플로우 (Exception Flows)

| 상황 | 처리 |
| :--- | :--- |
| 결제 실패 | 실패 사유 표시 + 재시도 버튼 + 주문 무효화 |
| 중복 결제 | 관리자 확인 후 1건 환불 처리 |
| 배정 지연 (SLA 초과) | 관리자 알림 + 사용자 안내 SMS |
| 계정 정보 오입력 | 사용자 문의 → 관리자 수정 후 SMS 재발송 |
| 미가입 사용자 결제 시도 | 로그인/회원가입 페이지로 리다이렉트 |
| 관리자 미인가 접근 | `/admin` 접근 시 403 에러 → 메인 이동 |

---

## 5. 권한 관리 (Permission Management)

| 역할 (Role) | 설명 | 접근 가능 영역 |
| :--- | :--- | :--- |
| **비회원 (Guest)** | 가입하지 않은 방문자 | 랜딩, 상품 목록, 상품 상세, FAQ, 공지사항 |
| **사용자 (User)** | 일반 가입 회원 | Guest 영역 + 결제, 마이페이지(본인 주문/계정 확인), 프로필 수정 |
| **관리자 (Admin)** | 플랫폼 운영자 | User 영역 + 어드민 대시보드, 전체 주문 관리, 계정 배정, 상품 관리, 계정 풀 관리, 공지/FAQ 관리, 매출 통계 |

**접근 제어 규칙:**
- 비회원이 결제 시도 시: 로그인 페이지로 리다이렉트 (결제 페이지 URL은 returnUrl로 보존)
- 일반 사용자가 `/admin` 접근 시: 403 에러 페이지 → 3초 후 메인 이동
- 마이페이지에서 타인의 주문/계정 정보 접근: Supabase RLS로 원천 차단

---

## 6. 화면 인벤토리 (Screen Inventory)

### 6.1 사용자 화면

| 화면 ID | 화면명 | 주요 구성 요소 | 접근 권한 |
| :--- | :--- | :--- | :--- |
| **SCR_LAND_001** | 랜딩 페이지 (메인) | 히어로 배너, 가격비교 차트, 3단계 이용방법, 베스트 리뷰, 공지사항 미리보기 | 전체 |
| **SCR_AUTH_001** | 로그인 | 이메일/PW 입력, 소셜 로그인 버튼, 비밀번호 찾기 링크, 회원가입 링크 | 전체 |
| **SCR_AUTH_002** | 회원가입 | 이메일/PW/PW확인/이름 입력, 이용약관 동의 체크박스 | 전체 |
| **SCR_AUTH_003** | 비밀번호 재설정 요청 | 이메일 입력 + 재설정 링크 발송 | 전체 |
| **SCR_AUTH_004** | 비밀번호 재설정 완료 | 새 비밀번호 입력/확인 | 전체 |
| **SCR_SHOP_001** | 상품 목록 | 서비스 카드 그리드 (아이콘, 이름, 가격, 할인율, 상태 뱃지) | 전체 |
| **SCR_SHOP_002** | 상품 상세 | 서비스 상세 설명, 혜택, 유의사항, 기간 선택 UI, 결제 금액 표시, 결제 버튼 | 전체 |
| **SCR_PAY_001** | 결제 진행 | PG 결제창 (PortOne 팝업/리다이렉트) | User |
| **SCR_PAY_002** | 결제 완료 | 주문 확인 정보, 배정 대기 안내 문구, 마이페이지 이동 버튼 | User |
| **SCR_PAY_003** | 결제 실패 | 실패 사유, 재시도 버튼, 고객센터 안내 | User |
| **SCR_MY_001** | 마이페이지 - 구독 현황 | 이용 중인 서비스 리스트 (ID/PW 복사, D-Day, 만료일), 배정 대기 건 표시, 만료 건 재구매 유도 | User |
| **SCR_MY_002** | 마이페이지 - 주문 내역 | 전체 주문 히스토리 (상태, 결제일, 금액) | User |
| **SCR_MY_003** | 마이페이지 - 프로필 수정 | 이름, 비밀번호 변경, 휴대폰 번호 수정 | User |
| **SCR_NOTICE_001** | 공지사항 목록 | 공지 리스트 (제목, 날짜, 카테고리) | 전체 |
| **SCR_NOTICE_002** | 공지사항 상세 | 공지 본문 | 전체 |
| **SCR_FAQ_001** | FAQ | 아코디언 형태 질문/답변 리스트. 카테고리 필터 | 전체 |
| **SCR_ERR_403** | 접근 제한 | "접근 권한이 없습니다" 안내 + 메인 이동 | 전체 |

### 6.2 관리자 화면

| 화면 ID | 화면명 | 주요 구성 요소 | 접근 권한 |
| :--- | :--- | :--- | :--- |
| **SCR_ADM_001** | 주문 관리 대시보드 | 주문 리스트 (상태 필터/서비스 필터), 상태 변경, 매출 합계, 검색 | Admin |
| **SCR_ADM_002** | 계정 배정 | 결제완료 건 ID/PW 입력 필드, 계정 풀 연동 선택, 배정 확인 버튼 | Admin |
| **SCR_ADM_003** | 상품 관리 | 서비스별 가격/할인율/태그/활성 상태 수정 | Admin |
| **SCR_ADM_004** | 계정 풀 관리 | 공유 계정 CRUD, 배정 현황, 서비스 매핑 | Admin |
| **SCR_ADM_005** | 공지/FAQ 관리 | 공지사항·FAQ CRUD | Admin |
| **SCR_ADM_006** | 매출 통계 | 기간별/서비스별 매출 차트, 주문 건수, 신규 가입자 수 | Admin |

---

## 7. 요구사항 리스트 (Backlog)

### 7.1 회원가입 / 로그인

| ID | 우선순위 | 요구사항 명칭 | 상세 설명 및 수용 기준 (AC) | 관련 화면 | 상태 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| REQ-1.1 | **P0** | 기본 회원가입 | 이메일, 비밀번호(8자 이상, 영문/숫자 조합), 이름, 휴대폰 번호 입력. 중복 이메일 체크. 이용약관/개인정보처리방침 동의 체크박스 필수 | SCR_AUTH_002 | 진행중 |
| REQ-1.2 | **P0** | 로그인/로그아웃 | 이메일+비밀번호 로그인. JWT 토큰 발급 및 세션 유지. 실패 시 "이메일 또는 비밀번호가 올바르지 않습니다" 공통 메시지 | SCR_AUTH_001 | 진행중 |
| REQ-1.3 | **P1** | 비밀번호 찾기 및 재설정 | 이메일 인증을 통해 재설정 토큰 포함 이메일 발송. 토큰 유효시간 30분 | SCR_AUTH_003, 004 | 대기 |
| REQ-1.4 | **P2** | 소셜 로그인 (Google) | OAuth 2.0 기반. 최초 로그인 시 자동 가입. 기존 동일 이메일 계정 연동 | SCR_AUTH_001 | 검토 |

### 7.2 상품 탐색

| ID | 우선순위 | 요구사항 명칭 | 상세 설명 및 수용 기준 (AC) | 관련 화면 | 상태 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| REQ-2.1 | **P0** | 서비스 목록 조회 | 활성화된 모든 구독 상품 카드 형태 노출 (아이콘, 이름, 월 이용료, 할인율). 품절/비활성 상품은 '준비 중' 뱃지 | SCR_SHOP_001 | 진행중 |
| REQ-2.2 | **P0** | 서비스 상세 정보 | 서비스 혜택, 유의사항, 기간별 가격표, 기간 선택 UI, 결제 버튼 | SCR_SHOP_002 | 진행중 |
| REQ-2.3 | **P1** | 상품 검색/필터 | 키워드 검색. 결과 없을 시 대체 상품 추천 노출 | SCR_SHOP_001 | 대기 |

### 7.3 결제

| ID | 우선순위 | 요구사항 명칭 | 상세 설명 및 수용 기준 (AC) | 관련 화면 | 상태 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| REQ-3.1 | **P0** | 기간 선택 및 결제 | 1/3개월 옵션 선택 시 결제 금액 자동 계산. PortOne PG 결제창 호출. 비회원 시 로그인 유도 | SCR_SHOP_002, PAY_001 | 진행중 |
| REQ-3.2 | **P0** | 주문 생성 로직 | 결제 검증(Webhook) 성공 시 `orders` 테이블 기록. 상태: '결제완료' | - | 진행중 |
| REQ-3.3 | **P0** | 결제 완료 화면 | 주문 요약 정보 + 배정 대기 안내("영업시간 기준 2시간 이내 SMS 발송") + 마이페이지 이동 버튼 | SCR_PAY_002 | 진행중 |
| REQ-3.4 | **P1** | 결제 예외 처리 | 한도 초과, 네트워크 오류 등 실패 시 주문 무효화 + 실패 사유 안내 + 재시도 버튼 | SCR_PAY_003 | 대기 |

### 7.4 마이페이지

| ID | 우선순위 | 요구사항 명칭 | 상세 설명 및 수용 기준 (AC) | 관련 화면 | 상태 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| REQ-4.1 | **P0** | 공유 계정 정보 조회 | 이용 중인 서비스의 ID/PW 텍스트 노출 + 복사 버튼. 남은 구독 기간(D-Day) 및 만료일 표시 | SCR_MY_001 | 진행중 |
| REQ-4.2 | **P0** | 배정 대기 상태 표시 | 결제 완료~배정 전 건은 "배정 대기 중" 상태 카드로 노출. 예상 배정 시간 안내 | SCR_MY_001 | 진행중 |
| REQ-4.3 | **P1** | 주문 내역 | 전체 주문 히스토리. 상태, 결제일, 금액, 서비스명 표시 | SCR_MY_002 | 대기 |
| REQ-4.4 | **P1** | 프로필 수정 | 이름, 비밀번호, 휴대폰 번호 변경 | SCR_MY_003 | 대기 |
| REQ-4.5 | **P1** | 만료 안내 및 재구매 유도 | 만료 임박/만료 건에 재구매 배너 노출. 만료 후 계정 정보 비노출 | SCR_MY_001 | 대기 |

### 7.5 알림

| ID | 우선순위 | 요구사항 명칭 | 상세 설명 및 수용 기준 (AC) | 관련 화면 | 상태 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| REQ-5.1 | **P0** | 계정 배정 SMS 알림 | 배정 완료 시 사용자 휴대폰에 SMS 발송. 내용: 서비스명 + 마이페이지 확인 유도 | - | 대기 |
| REQ-5.2 | **P1** | 만료 임박 SMS 알림 | D-7, D-1 시점에 SMS 발송. 재구매 유도 링크 포함 | - | 대기 |
| REQ-5.3 | **P2** | 계정 교체 SMS 알림 | 장애로 인한 계정 교체 시 일괄 SMS 발송 | - | 대기 |

### 7.6 관리자 기능

| ID | 우선순위 | 요구사항 명칭 | 상세 설명 및 수용 기준 (AC) | 관련 화면 | 상태 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| REQ-6.1 | **P0** | 주문 관리 대시보드 | 전체 주문 조회. 상태별/서비스별 필터. 상태 변경(완료→취소 등). 매출 합계 | SCR_ADM_001 | 진행중 |
| REQ-6.2 | **P0** | 계정 배정 | 결제완료 건에 공유 계정(ID/PW) 입력 또는 풀에서 선택. 배정 시 SMS 자동 트리거 | SCR_ADM_002 | 진행중 |
| REQ-6.3 | **P0** | 공유 계정 풀 관리 | 계정 CRUD (서비스, ID, PW, 상태: 미배정/배정중/비활성). 계정별 배정 이력 | SCR_ADM_004 | 진행중 |
| REQ-6.4 | **P1** | 서비스/가격 관리 | 상품 가격, 할인율, 태그, 활성/비활성 실시간 수정 | SCR_ADM_003 | 진행중 |
| REQ-6.5 | **P1** | 접근 제한 | 관리자 권한 없는 사용자의 `/admin` 접속 시 403 → 메인 리다이렉트 | SCR_ERR_403 | 대기 |
| REQ-6.6 | **P1** | 공지사항/FAQ 관리 | 공지 및 FAQ CRUD. 카테고리 분류, 노출 순서 관리 | SCR_ADM_005 | 대기 |
| REQ-6.7 | **P2** | 매출 통계 | 기간별/서비스별 매출 차트, 누적 주문 건수, 신규 가입자 수 | SCR_ADM_006 | 대기 |

### 7.7 공지/FAQ/고객지원

| ID | 우선순위 | 요구사항 명칭 | 상세 설명 및 수용 기준 (AC) | 관련 화면 | 상태 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| REQ-7.1 | **P1** | 공지사항 | 공지 목록/상세 조회. 카테고리(일반, 계정교체, 이벤트). 최신순 정렬 | SCR_NOTICE_001, 002 | 대기 |
| REQ-7.2 | **P1** | FAQ | 아코디언 형태. 카테고리 필터 (결제, 계정, 서비스 등). 검색 기능 | SCR_FAQ_001 | 대기 |
| REQ-7.3 | **P1** | 고객 문의 채널 | 채널톡 위젯 삽입 (플로팅 버튼). 카카오톡 채널 링크 | 전체 화면 | 대기 |

### 7.8 랜딩 페이지

| ID | 우선순위 | 요구사항 명칭 | 상세 설명 및 수용 기준 (AC) | 관련 화면 | 상태 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| REQ-8.1 | **P0** | 랜딩 페이지 | 히어로 배너(CTA), 가격 비교 섹션, 3단계 이용 방법, 베스트 리뷰, 최신 공지 미리보기, 서비스 시작하기 버튼 | SCR_LAND_001 | 진행중 |

---

## 8. Jira 기반 상세 요구사항 (Epics & Issues)

### [Epic 1] 로그인 및 사용자 인증 체계 구축

**이슈 1-1: 이메일 기반 회원가입 및 로그인**

1. **사용자 스토리 (User Story)**
    - **As a** 서비스에 처음 방문하거나 기존 계정이 있는 사용자
    - **I want to** 이메일 주소를 사용해 회원가입을 하거나 로그인하고 싶다
    - **So that** 개인화된 서비스를 이용하고 내 주문/계정 데이터를 안전하게 관리하고 싶다
2. **수용 기준 (Acceptance Criteria)**
    - [ ] 회원가입 필드: 이메일, 비밀번호(8자 이상, 영문/숫자 조합), 비밀번호 확인, 이름, 휴대폰 번호
    - [ ] 이용약관 및 개인정보처리방침 동의 체크박스 필수 (미동의 시 가입 불가)
    - [ ] 이메일 형식 불일치 / 비밀번호 조건 미충족 / 비밀번호 불일치 시 즉각 인라인 에러 노출
    - [ ] 중복 이메일 가입 시도 시 "이미 사용 중인 이메일입니다" 안내
    - [ ] 로그인 성공 시 JWT 발급 + 이전 페이지(또는 메인)로 리다이렉트
    - [ ] 로그인 실패 시 "이메일 또는 비밀번호가 올바르지 않습니다" 공통 메시지 (보안)
3. **관련 화면**: SCR_AUTH_001, SCR_AUTH_002
4. **기술적 고려사항**
    - 비밀번호 BCrypt 해시 처리 (Supabase Auth 기본 지원)
    - 휴대폰 번호: SMS 알림 발송용. 형식 검증(010-xxxx-xxxx)

**이슈 1-2: 소셜 로그인 연동 (Google)**

1. **사용자 스토리**
    - **As a** 빠르고 간편한 가입을 선호하는 사용자
    - **I want to** 구글 계정을 통해 원클릭으로 로그인하고 싶다
    - **So that** 별도의 비밀번호를 기억할 필요 없이 서비스를 이용하고 싶다
2. **수용 기준**
    - [ ] 로그인 화면 상단에 'Google로 계속하기' 버튼 노출
    - [ ] 최초 로그인 시 자동 회원가입 처리 후 메인/이전 페이지 진입
    - [ ] 기존 이메일 가입 유저가 동일 구글 메일로 로그인 시 계정 연동
    - [ ] 소셜 로그인 시 휴대폰 번호 미입력 → 마이페이지에서 추후 입력 유도
3. **관련 화면**: SCR_AUTH_001
4. **기술적 고려사항**: Supabase Auth Google Provider 활용

**이슈 1-3: 비밀번호 찾기 및 재설정**

1. **사용자 스토리**
    - **As a** 비밀번호를 잊어버린 사용자
    - **I want to** 이메일을 통해 비밀번호 재설정 링크를 받고 싶다
    - **So that** 계정 액세스 권한을 다시 찾고 싶다
2. **수용 기준**
    - [ ] 로그인 화면 내 '비밀번호를 잊으셨나요?' 링크 제공
    - [ ] 가입된 이메일 입력 시 재설정 토큰 포함 이메일 발송 (유효시간 30분)
    - [ ] 미가입 이메일 입력 시에도 동일한 "발송 완료" 메시지 노출 (보안)
    - [ ] 재설정 완료 후 로그인 페이지로 이동, 즉시 새 비밀번호로 로그인 가능
3. **관련 화면**: SCR_AUTH_003, SCR_AUTH_004

---

### [Epic 2] 랜딩 페이지 및 상품 탐색

**이슈 2-1: 랜딩 페이지**

1. **사용자 스토리**
    - **As a** 구독 비용 절약에 관심 있는 방문자
    - **I want to** 서비스의 가치와 신뢰성을 한눈에 파악하고 싶다
    - **So that** 안심하고 서비스를 이용할지 판단하고 싶다
2. **수용 기준**
    - [ ] 히어로 배너: 핵심 가치 제안 + '서비스 시작하기' CTA 버튼
    - [ ] 가격 비교 섹션: 정가 vs 달버스 가격 시각적 비교 (차트 또는 표)
    - [ ] 이용 방법 3단계: 구매하기 → SMS 정보 확인 → 서비스 이용
    - [ ] 베스트 리뷰 섹션: 대표 후기 3~5건 캐러셀
    - [ ] 최신 공지 미리보기: 최근 공지 3~5건 리스트 + "더보기" 링크
    - [ ] Glassmorphism 디자인 적용. 모바일 최적화 필수
3. **관련 화면**: SCR_LAND_001

**이슈 2-2: 서비스 카탈로그 및 상세 정보**

1. **사용자 스토리**
    - **As a** 프리미엄 구독료를 절약하고 싶은 방문자
    - **I want to** 이용 가능한 서비스 리스트와 할인 금액을 확인하고 싶다
    - **So that** 내가 필요한 서비스가 있는지, 얼마나 저렴한지 판단하고 싶다
2. **수용 기준**
    - [ ] 상품 목록: 서비스 아이콘, 이름, 월 이용료, 할인율이 카드 형태로 노출
    - [ ] 상품 상태 뱃지: 판매중 / 준비중 / 매진
    - [ ] 상세 페이지: 서비스 혜택, 유의사항, 기간별 가격표, 기간 선택 라디오/탭, 결제 버튼
    - [ ] 비활성/품절 상품은 결제 버튼 비활성화 + "현재 이용 불가" 안내
3. **관련 화면**: SCR_SHOP_001, SCR_SHOP_002

---

### [Epic 3] 구독 주문 및 결제 프로세스

**이슈 3-1: 결제 옵션 선택 및 주문 생성**

1. **사용자 스토리**
    - **As a** 서비스를 이용하기로 결정한 구매자
    - **I want to** 이용 기간을 선택하고 결제를 완료하고 싶다
    - **So that** 신속하게 공유 계정 권한을 획득하고 싶다
2. **수용 기준**
    - [ ] 기간 선택(1개월/3개월 등) 시 결제 금액 자동 계산 및 노출
    - [ ] 비회원 결제 시도 시: 로그인 페이지 이동 → 로그인 후 결제 화면 자동 복귀
    - [ ] PortOne PG사 연동: 카드, 카카오페이, 토스페이 등 다양한 결제 수단
    - [ ] 결제 성공: `orders` 테이블 생성 (상태: '결제완료') → 결제 완료 화면
    - [ ] 결제 완료 화면: 주문 요약 + "영업시간 기준 2시간 이내 SMS 발송" 안내 + 마이페이지 이동 버튼
    - [ ] 결제 실패: 실패 사유 안내 + 재시도 버튼 + 고객센터 안내
    - [ ] 결제 검증: PortOne Webhook으로 서버사이드 검증. 금액 불일치 시 주문 무효화
3. **관련 화면**: SCR_SHOP_002, SCR_PAY_001, SCR_PAY_002, SCR_PAY_003
4. **기술적 고려사항**
    - PortOne V2 SDK 사용
    - Webhook 기반 결제 검증 (클라이언트 검증에 의존하지 않음)
    - 결제 트랜잭션은 `payments` 테이블에 별도 기록

---

### [Epic 4] 마이페이지 및 구독 관리

**이슈 4-1: 공유 계정 정보 조회 및 구독 현황**

1. **사용자 스토리**
    - **As a** 결제를 완료한 실사용자
    - **I want to** 내가 사용할 서비스의 ID/PW 정보를 확인하고 싶다
    - **So that** 실제 서비스(Tidal 등)에 로그인하여 이용하고 싶다
2. **수용 기준**
    - [ ] '이용 중인 서비스' 카드: ID/PW 텍스트 노출 + 복사 버튼 (각각 독립 복사)
    - [ ] 만료일 및 남은 기간 D-Day 표시
    - [ ] 배정 대기 건: "배정 대기 중" 상태 카드 (예상 배정 시간 안내)
    - [ ] 만료된 건: 계정 정보 비노출 + 재구매 유도 배너
    - [ ] Supabase RLS: 본인 주문만 조회 가능
3. **관련 화면**: SCR_MY_001, SCR_MY_002

---

### [Epic 5] 플랫폼 어드민 운영 관리

**이슈 5-1: 주문 현황 및 계정 배정**

1. **사용자 스토리**
    - **As a** 달버스 플랫폼 운영자
    - **I want to** 사용자의 결제 내역을 확인하고 계정 정보를 배정하고 싶다
    - **So that** 고객 서비스가 지연 없이 원활하게 제공되도록 관리하고 싶다
2. **수용 기준**
    - [ ] 주문 리스트: 상태별 필터 (결제대기/결제완료/배정완료/이용중/만료/취소)
    - [ ] 서비스별 필터, 날짜 범위 검색, 사용자 검색
    - [ ] '결제완료' 건에 ID/PW 배정 입력 필드 (직접 입력 또는 계정 풀에서 선택)
    - [ ] 배정 완료 시: 주문 상태 자동 변경 ('배정완료') + SMS 자동 트리거
    - [ ] 매출 합계 통계: 필터링된 주문의 총 결제 금액 합산 표시
3. **관련 화면**: SCR_ADM_001, SCR_ADM_002

**이슈 5-2: 공유 계정 풀 관리**

1. **사용자 스토리**
    - **As a** 달버스 플랫폼 운영자
    - **I want to** 서비스별 공유 계정을 체계적으로 관리하고 싶다
    - **So that** 계정 배정 시 빠르게 가용 계정을 찾고, 장애 시 영향 범위를 파악하고 싶다
2. **수용 기준**
    - [ ] 계정 등록: 서비스 매핑, ID, PW, 메모
    - [ ] 계정 상태: 미배정 / 배정중 / 비활성(차단/만료)
    - [ ] 계정별 현재 배정된 주문 리스트 확인
    - [ ] 비활성 처리 시 해당 계정으로 배정된 활성 주문에 경고 표시
3. **관련 화면**: SCR_ADM_004

**이슈 5-3: 상품 및 가격 관리**

1. **사용자 스토리**
    - **As a** 달버스 플랫폼 운영자
    - **I want to** 상품 가격과 정보를 실시간으로 수정하고 싶다
    - **So that** 시장 상황에 맞게 유연하게 운영하고 싶다
2. **수용 기준**
    - [ ] 서비스별 기간권 가격 수정 (즉시 반영)
    - [ ] 할인율 자동 계산 (정가 대비)
    - [ ] 상품 활성/비활성 토글
    - [ ] 태그 수정 (인기, 신규, HOT 등)
3. **관련 화면**: SCR_ADM_003

---

### [Epic 6] 공지사항, FAQ 및 고객지원

**이슈 6-1: 공지사항**

1. **사용자 스토리**
    - **As a** 서비스 이용자
    - **I want to** 계정 교체, 서비스 변경 등 중요 공지를 확인하고 싶다
    - **So that** 서비스 이용에 차질이 없도록 대비하고 싶다
2. **수용 기준**
    - [ ] 공지 목록: 제목, 날짜, 카테고리(일반/계정교체/이벤트). 최신순 정렬
    - [ ] 공지 상세: 본문(Markdown 또는 Rich Text)
    - [ ] 랜딩 페이지에 최신 공지 3건 미리보기 노출
3. **관련 화면**: SCR_NOTICE_001, SCR_NOTICE_002

**이슈 6-2: FAQ**

1. **수용 기준**
    - [ ] 아코디언 형태 Q&A 리스트
    - [ ] 카테고리 필터: 결제, 계정, 서비스 이용, 환불 등
    - [ ] 관리자가 FAQ 항목 CRUD 가능
2. **관련 화면**: SCR_FAQ_001

**이슈 6-3: 고객 문의 채널 연동**

1. **수용 기준**
    - [ ] 채널톡 위젯: 전체 페이지 우하단 플로팅 버튼
    - [ ] 카카오톡 채널: 고객센터 링크 (Footer 및 FAQ 페이지)
2. **관련 화면**: 전체

---

## 9. 핵심 데이터 모델 (Entity Hints)

> ※ 이 섹션은 기술 설계서 작성을 위한 힌트입니다. 실제 스키마는 기술 설계서에서 확정합니다.

### 9.1 핵심 엔티티

| 엔티티 | 설명 | 주요 필드 (예시) |
| :--- | :--- | :--- |
| **users** | 회원 정보 | id, email, name, phone, role(user/admin), created_at |
| **services** | 판매 서비스 | id, name, icon_url, description, benefits, cautions, is_active, display_order |
| **plans** | 요금제 (서비스×기간) | id, service_id(FK), duration_months, original_price, selling_price, discount_rate, is_active |
| **orders** | 주문 | id, user_id(FK), plan_id(FK), status, amount, shared_account_id(FK), ordered_at, expires_at |
| **payments** | 결제 이력 | id, order_id(FK), pg_transaction_id, method, amount, status, paid_at |
| **shared_accounts** | 공유 계정 풀 | id, service_id(FK), account_id_encrypted, account_pw_encrypted, status(미배정/배정중/비활성), memo |
| **notices** | 공지사항 | id, title, content, category, is_published, created_at |
| **faqs** | FAQ | id, question, answer, category, display_order, is_published |
| **sms_logs** | SMS 발송 이력 | id, user_id(FK), order_id(FK), type(배정/만료임박/계정교체), sent_at, status |

### 9.2 주문 상태 전이 (State Machine)

```
결제대기(pending) ──결제성공──→ 결제완료(paid)
     │                           │
     │                    ┌──────┤
     │                    │      │
     ▼                    ▼      ▼
 결제실패(failed)    취소(cancelled)  배정완료(assigned)
                                     │
                                     ▼
                                이용중(active)
                                     │
                                     ▼
                                만료(expired)
```

| 현재 상태 | 이벤트 | 다음 상태 | 트리거 |
| :--- | :--- | :--- | :--- |
| 결제대기 | PG 결제 성공 | 결제완료 | Webhook |
| 결제대기 | PG 결제 실패 | 결제실패 | Webhook |
| 결제완료 | 관리자 계정 배정 | 배정완료 | Admin 액션 |
| 결제완료 | 관리자 취소 처리 | 취소 | Admin 액션 |
| 배정완료 | - (자동) | 이용중 | 배정 즉시 |
| 이용중 | 만료일 도래 | 만료 | Cron/Scheduler |
| 이용중 | 관리자 취소 | 취소 | Admin 액션 |

### 9.3 공유 계정 상태

| 상태 | 설명 |
| :--- | :--- |
| 미배정 (available) | 배정 가능한 유휴 계정 |
| 배정중 (assigned) | 현재 활성 주문에 배정된 상태 |
| 비활성 (disabled) | 차단/만료/장애로 사용 불가 |

### 9.4 보안 요구사항 (데이터 관련)

- 공유 계정 ID/PW: 암호화 저장 (AES-256 또는 Supabase Vault)
- 사용자 비밀번호: BCrypt 해시 (Supabase Auth 기본)
- 마이페이지 조회: Supabase RLS로 `auth.uid() = user_id` 조건 강제
- 관리자 API: `role = 'admin'` RLS 정책 적용
- 결제 금액 검증: 서버사이드 Webhook에서 PG 응답 금액과 주문 금액 대조

---

## 10. 제약 사항 및 기술 요구사항 (Constraints)

| 분류 | 요구사항 |
| :--- | :--- |
| **성능** | Next.js 15 App Router + PPR 활용. 첫 페이지 LCP 2.0초 이하 |
| **보안** | Supabase RLS 전면 적용. 공유 계정 ID/PW 암호화 저장/전송. HTTPS 필수 |
| **호환성** | 모바일 브라우저(Safari, Chrome) 최우선 최적화. 데스크탑 Glassmorphism 정상 렌더링 |
| **인프라** | Vercel (Frontend) + Supabase (Backend/DB/Auth) |
| **디자인** | Glassmorphism 기반. 모바일 퍼스트 반응형 |
| **SEO** | 랜딩·상품 페이지 SSR/SSG 적용. meta 태그, OG 태그 |

---

## 11. 외부 서비스 의존성 (Dependencies)

| 서비스 | 용도 | 비고 |
| :--- | :--- | :--- |
| **Supabase Auth** | 회원가입, 로그인, 소셜 로그인, 비밀번호 재설정 | Google OAuth Provider 설정 필요 |
| **Supabase Database** | PostgreSQL DB, RLS | 핵심 데이터 저장 |
| **Supabase Vault** | 공유 계정 ID/PW 암호화 저장 | 또는 애플리케이션 레벨 AES-256 |
| **PortOne (V2)** | PG 결제 대행 | 카드, 카카오페이, 토스페이 등 |
| **SMS API** | 알림톡/SMS 발송 | NHN Cloud, 알리고 등 선택 필요 |
| **채널톡** | 고객 문의 위젯 | 스크립트 삽입 |
| **카카오톡 채널** | 고객센터 링크 | 별도 개설 필요 |
| **Vercel** | 프론트엔드 호스팅, Edge Functions | Next.js 배포 |

---

## 12. 법적 요구사항

| 항목 | 설명 | 관련 화면 |
| :--- | :--- | :--- |
| **이용약관** | 서비스 이용 조건, 환불 정책, 면책 조항 명시 | Footer 링크, 회원가입 동의 |
| **개인정보처리방침** | 수집 항목(이메일, 이름, 전화번호), 이용 목적, 보유 기간, 제3자 제공 등 | Footer 링크, 회원가입 동의 |
| **사업자 정보 표시** | 대표자명, 회사명, 주소, 사업자등록번호, 통신판매업 신고번호 | Footer |
| **전자상거래법** | 청약철회(환불) 안내, 결제 전 주문 내용 확인 | 결제 화면 |

---

## 13. 제외 사항 (Out of Scope)

| 항목 | 사유 |
| :--- | :--- |
| 결제 자동 취소/환불 | MVP에서는 관리자 수동 처리 |
| 자동 계정 배정 | MVP에서는 관리자 수동 배정 |
| 커뮤니티 기능 | 사용자 간 대화·게시판 불필요 |
| 다국어 지원 | 초기 버전 한국어만 |
| 자동 구독 갱신 | MVP에서는 수동 재구매 |
| 추천인/캐시 시스템 | MVP 이후 마케팅 기능으로 검토 |
| 리뷰 시스템 (사용자 작성) | MVP에서는 운영자가 관리하는 정적 리뷰만 노출 |

---

## 💡 작성 가이드 (LED Principle)

- **P0에 집중**: MVP 단계에서는 회원가입/로그인, 상품 탐색, 결제, 마이페이지(계정 확인), 관리자 배정의 성공적 구현이 프로젝트의 성패를 좌우합니다.
- **수용 기준의 구체화**: "보안 강화" 대신 "Supabase RLS 적용 및 쿼리 테스트 통과"와 같이 검증 가능한 기준으로 관리합니다.
- **문서의 생동감**: 개발 중 발견되는 예외 케이스(예: 중복 결제, 계정 교체 등)는 즉시 REQ 리스트에 업데이트합니다.
- **버전 관리**: 주요 변경 시 문서 버전과 수정일을 갱신합니다.

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 |
| :--- | :--- | :--- |
| v1.0 | 2025-02-06 | 초안 작성 |
| v2.0 | 2025-02-07 | 비즈니스 모델/운영 정책 추가, 사용자 여정 추가, 화면 인벤토리 전면 보강, 데이터 모델 힌트 추가, 알림/공지/FAQ/고객지원 요구사항 추가, 법적 요구사항 추가, 외부 서비스 의존성 정리 |
